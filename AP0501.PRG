SELECT 1
USE APPERSON INDEX APPERSO1,APPERSO2,APPERSO3,APPERSO4
*INDEX ON CEDULA                             TO APPERSO1
*INDEX ON GRUPO+NOMINA+DIRE+DEPA+SECC+CEDULA TO APPERSO2
*INDEX ON DIRE+DEPA+SECC+CEDULA              TO APPERSO3
*INDEX ON APELLIDOS+NOMBRES                  TO APPERSO4
SELECT 2
USE APCONPER INDEX APCONPER
*INDEX ON CEDULA+CONCEPTO TO APCONPER
SELECT 3
USE APPAGGEN INDEX APPAGGE1,APPAGGE2
*INDEX ON CEDULA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2)) TO APPAGGE1
*INDEX ON GRUPO+NOMINA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+DIRE+DEPA+SECC+CEDULA TO APPAGGE2
SELECT 4
USE APPAGCON INDEX APPAGCO1,APPAGCO2
*INDEX ON CEDULA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CONCEPTO TO APPAGCO1
*INDEX ON CONCEPTO+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CEDULA TO APPAGCO2
SELECT 5
USE APHISGEN INDEX APHISGE1,APHISGE2
*INDEX ON CEDULA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2)) TO APHISGE1
*INDEX ON GRUPO+NOMINA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+DIRE+DEPA+SECC+CEDULA TO APHISGE2
SELECT 6
USE APHISCON INDEX APHISCO1,APHISCO2
*INDEX ON CEDULA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CONCEPTO TO APHISCO1
*INDEX ON CONCEPTO+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CEDULA TO APHISCO2

STORE .T. TO WMODI
DO WHILE WMODI
   @ 4,0 CLEAR TO 8,60
   @ 5,0 TO 8,60
   @ 4,0 SAY "CAMBIO DE CEDULAS ERRADAS"
   @ 6,1 SAY "CEDULA ERRADA :"
   @ 7,1 SAY "CEDULA REAL   :"
   STORE SPACE(12) TO WOLDCED
   STORE SPACE(12) TO WNEWCED
   @ 6,17 GET WOLDCED
   READ
   IF WOLDCED = SPACE(12) .OR. READKEY() = 12 .OR. READKEY() = 268
      EXIT
   ENDIF
   SELECT 1
   FIND &WOLDCED
   IF EOF()
      STORE "NO REGISTRADA EN MAESTRO DE PERSONAL" TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   @ 6,32 SAY RTRIM(APELLIDOS)+", "+RTRIM(NOMBRES)
   @ 7,17 GET WNEWCED
   READ
   IF WNEWCED = SPACE(12) .OR. READKEY() = 12 .OR. READKEY() = 268
      EXIT
   ENDIF
   SELECT 1
   FIND &WNEWCED
   IF .NOT. EOF()
      STORE "YA REGISTRADA EN MAESTRO COMO: "+RTRIM(APELLIDOS)+", "+RTRIM(NOMBRES) TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   STORE "OPCIONES: (C)ONTINUAR, (S)ALIR" TO TEX
   STORE "SC" TO WCH
   DO PREGUNTA
   IF WCH = "S"
      LOOP
   ENDIF
   STORE "REEMPLAZANDO EN MAESTRO DE PERSONAL..." TO MES
   DO MENSAJE WITH MES
   SELECT 1
   FIND &WOLDCED
   IF .NOT. EOF()
      DO RECLOC
      REPLACE CEDULA WITH WNEWCED
      UNLOCK  
   ELSE
      STORE "ERROR, CEDULA VIEJA NO EXISTE EN MAESTRO" TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   STORE "REEMPLAZANDO EN CONCEPTOS NOMINALES..." TO MES
   DO MENSAJE WITH MES
   SELECT 2
   STORE .T. TO WREPLACEING
   DO WHILE WREPLACEING
      FIND &WOLDCED
      IF EOF()
         EXIT
      ELSE
         DO RECLOC
         REPLACE CEDULA WITH WNEWCED
         UNLOCK
      ENDIF
   ENDDO
   STORE "REEMPLAZANDO EN PAGO GENERAL..." TO MES
   DO MENSAJE WITH MES
   SELECT 3
   STORE .T. TO WREPLACEING
   DO WHILE WREPLACEING
      FIND &WOLDCED
      IF EOF()
         EXIT
      ELSE
         DO RECLOC
         REPLACE CEDULA WITH WNEWCED
         UNLOCK
      ENDIF
   ENDDO
   STORE "REEMPLAZANDO EN PAGO CONCEPTUAL..." TO MES
   DO MENSAJE WITH MES
   SELECT 4
   STORE .T. TO WREPLACEING
   DO WHILE WREPLACEING
      FIND &WOLDCED
      IF EOF()
         EXIT
      ELSE
         DO RECLOC
         REPLACE CEDULA WITH WNEWCED
         UNLOCK
      ENDIF
   ENDDO
   STORE "REEMPLAZANDO EN HISTORICO GENERAL..." TO MES
   DO MENSAJE WITH MES
   SELECT 5
   STORE .T. TO WREPLACEING
   DO WHILE WREPLACEING
      FIND &WOLDCED
      IF EOF()
         EXIT
      ELSE
         DO RECLOC
         REPLACE CEDULA WITH WNEWCED
         UNLOCK
      ENDIF
   ENDDO
   STORE "REEMPLAZANDO EN HISTORICO CONCEPTUAL..." TO MES
   DO MENSAJE WITH MES
   SELECT 6
   STORE .T. TO WREPLACEING
   DO WHILE WREPLACEING
      FIND &WOLDCED
      IF EOF()
         EXIT
      ELSE
         DO RECLOC
         REPLACE CEDULA WITH WNEWCED
         UNLOCK
      ENDIF
   ENDDO
ENDDO
CLOSE DATA
CLOSE INDEX
RETURN

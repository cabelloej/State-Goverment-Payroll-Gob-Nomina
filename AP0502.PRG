SELECT 1
USE APCON INDEX APCON                               
*INDEX ON CODIGO  TO APCON    
SELECT 2
USE APCONPER INDEX APCONPER
*INDEX ON CEDULA+CONCEPTO TO APCONPER
SELECT 4
USE APPAGCON INDEX APPAGCO2,APPAGCO1
*INDEX ON CEDULA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CONCEPTO TO APPAGCO1
*INDEX ON CONCEPTO+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CEDULA TO APPAGCO2
SELECT 6
USE APHISCON INDEX APHISCO2,APHISCO1
*INDEX ON CEDULA+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CONCEPTO TO APHISCO1
*INDEX ON CONCEPTO+STR(YEAR(FECHA2))+STR(MONTH(FECHA2))+STR(DAY(FECHA2))+CEDULA TO APHISCO2

STORE .T. TO WMODI
DO WHILE WMODI
   UNLOCK ALL
   @ 4,0 CLEAR TO 8,60
   @ 5,0 TO 8,60
   @ 4,0 SAY "CAMBIO DE CODIGO DE CONCEPTOS"
   @ 6,1 SAY "CODIGO ERRADO :"
   @ 7,1 SAY "CODIGO REAL   :"
   STORE SPACE(4) TO WOLDCOD
   STORE SPACE(4) TO WNEWCOD
   @ 6,17 GET WOLDCOD
   READ
   IF WOLDCOD = SPACE(4) .OR. READKEY() = 12 .OR. READKEY() = 268
      EXIT
   ENDIF
   SELECT 1
   FIND &WOLDCOD
   IF EOF()
      STORE "NO REGISTRADO EN MAESTRO DE CONCEPTOS" TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   @ 6,32 SAY DESCRI
   @ 7,17 GET WNEWCOD
   READ
   IF WNEWCOD = SPACE(4) .OR. READKEY() = 12 .OR. READKEY() = 268
      EXIT
   ENDIF
   SELECT 1
   FIND &WNEWCOD
   IF .NOT. EOF()
      STORE "YA REGISTRADO EN MAESTRO COMO: "+RTRIM(DESCRI) TO MES
      DO AVISO WITH MES
      LOOP
   ENDIF
   STORE "OPCIONES: (C)ONTINUAR, (S)ALIR" TO TEX
   STORE "SC" TO WCH
   DO PREGUNTA
   IF WCH = "S"
      LOOP
   ENDIF
   STORE "REEMPLAZANDO EN MAESTRO DE CONCEPTOS..." TO MES
   DO MENSAJE WITH MES
   SELECT 1
   FIND &WOLDCOD
   IF .NOT. EOF()
      DO FILLOC
      REPLACE CONCEPTO WITH WNEWCOD
      UNLOCK  
   ENDIF
   STORE "REEMPLAZANDO EN CONCEPTOS NOMINALES..." TO MES
   DO MENSAJE WITH MES
   SELECT 2
   GO TOP
   DO WHILE .NOT. EOF()
      IF CONCEPTO = WOLDCOD
         DO RECLOC
         REPLACE CONCEPTO WITH WNEWCOD
         UNLOCK
      ENDIF
      SKIP
   ENDDO
   STORE "REEMPLAZANDO EN PAGO CONCEPTUAL..." TO MES
   DO MENSAJE WITH MES
   SELECT 4
   STORE .T. TO WREPLACEING
   DO WHILE WREPLACEING
      FIND &WOLDCOD
      IF EOF()
         EXIT
      ELSE
         DO RECLOC
         REPLACE CONCEPTO WITH WNEWCOD
         UNLOCK
      ENDIF
   ENDDO
   STORE "REEMPLAZANDO EN HISTORICO CONCEPTUAL..." TO MES
   DO MENSAJE WITH MES
   SELECT 6
   STORE .T. TO WREPLACEING
   DO WHILE WREPLACEING
      FIND &WOLDCOD
      IF EOF()
         EXIT
      ELSE
         DO RECLOC
         REPLACE CONCEPTO WITH WNEWCOD
         UNLOCK
      ENDIF
   ENDDO
ENDDO
CLOSE DATA
CLOSE INDEX
RETURN
